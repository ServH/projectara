<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ Galcon - Test Corregido</title>
    <link rel="stylesheet" href="css/main.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: radial-gradient(ellipse at center, #000033 0%, #000011 70%, #000000 100%);
            color: white;
            font-family: Arial, sans-serif;
            overflow: hidden;
        }
        
        .hud {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #00ff88;
            z-index: 1000;
            font-size: 14px;
        }
        
        .hud-title {
            color: #00ff88;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .hud-item {
            margin: 5px 0;
            display: flex;
            justify-content: space-between;
            min-width: 200px;
        }
        
        .hud-value {
            color: #00ff88;
            font-weight: bold;
        }
        
        .instructions {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.8);
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ffaa00;
            z-index: 1000;
            font-size: 12px;
            color: #ffaa00;
        }
        
        #gameCanvas {
            width: 100vw;
            height: 100vh;
            display: block;
        }
    </style>
</head>
<body>
    <!-- HUD -->
    <div class="hud">
        <div class="hud-title">üöÄ GALCON - Test Corregido</div>
        <div class="hud-item">
            <span>Estado:</span>
            <span class="hud-value" id="gameStatus">Iniciando...</span>
        </div>
        <div class="hud-item">
            <span>Planetas:</span>
            <span class="hud-value" id="planetCount">0</span>
        </div>
        <div class="hud-item">
            <span>Flotas:</span>
            <span class="hud-value" id="fleetCount">0</span>
        </div>
        <div class="hud-item">
            <span>FPS:</span>
            <span class="hud-value" id="fpsCount">0</span>
        </div>
        <div class="hud-item">
            <span>Seleccionados:</span>
            <span class="hud-value" id="selectedCount">0</span>
        </div>
        <div class="hud-item">
            <span>Porcentaje:</span>
            <span class="hud-value" id="percentageValue">50%</span>
        </div>
    </div>
    
    <!-- Instrucciones -->
    <div class="instructions">
        üñ±Ô∏è Click: Seleccionar planeta<br>
        üñ±Ô∏è Drag: Enviar flotas<br>
        üñ±Ô∏è Doble click: Seleccionar todos<br>
        üéõÔ∏è Rueda: Cambiar porcentaje
    </div>

    <!-- Canvas del Juego -->
    <svg id="gameCanvas"></svg>

    <!-- Scripts -->
    <script type="module">
        import GameEngine from './src/core/GameEngine.js';
        import Renderer from './src/visual/Renderer.js';
        import SelectionSystem from './src/systems/SelectionSystem.js';
        import DragDropHandler from './src/input/DragDropHandler.js';

        console.log('üöÄ Iniciando Galcon - Test Corregido...');

        try {
            // Inicializar sistemas
            const gameEngine = new GameEngine();
            const renderer = new Renderer(gameEngine);
            const selectionSystem = new SelectionSystem(gameEngine);
            const dragDropHandler = new DragDropHandler(gameEngine, selectionSystem);

            // Inicializar juego
            gameEngine.init();
            renderer.start();

            document.getElementById('gameStatus').textContent = 'Funcionando ‚úÖ';

            // Funci√≥n para actualizar HUD
            function updateHUD() {
                try {
                    const renderData = gameEngine.getRenderData();
                    
                    document.getElementById('planetCount').textContent = renderData.planets.length;
                    document.getElementById('fleetCount').textContent = renderData.fleets.length;
                    document.getElementById('fpsCount').textContent = Math.round(renderData.stats.fps);
                    document.getElementById('selectedCount').textContent = selectionSystem.selectedPlanets.size;
                    
                    if (gameEngine.percentageSelector) {
                        document.getElementById('percentageValue').textContent = 
                            gameEngine.percentageSelector.getCurrentPercentage() + '%';
                    }
                    
                    // Log de debug cada 5 segundos
                    if (Math.floor(Date.now() / 5000) % 2 === 0) {
                        console.log('üé® Estado del juego:');
                        console.log(`  Planetas: ${renderData.planets.length}`);
                        console.log(`  Flotas: ${renderData.fleets.length}`);
                        console.log(`  FPS: ${Math.round(renderData.stats.fps)}`);
                        
                        // Verificar colores de algunos planetas
                        renderData.planets.slice(0, 3).forEach(planet => {
                            console.log(`  ${planet.id}: ${planet.owner} -> ${planet.color}`);
                        });
                        
                        // Verificar elementos SVG en el DOM
                        const canvas = document.getElementById('gameCanvas');
                        const planetElements = canvas.querySelectorAll('.planet');
                        const fleetElements = canvas.querySelectorAll('.fleet');
                        console.log(`  Elementos SVG: ${planetElements.length} planetas, ${fleetElements.length} flotas`);
                    }
                    
                } catch (error) {
                    console.warn('‚ö†Ô∏è Error actualizando HUD:', error);
                }
            }

            // Actualizar HUD cada segundo
            setInterval(updateHUD, 1000);
            updateHUD(); // Primera actualizaci√≥n inmediata

            // Configurar eventos de prueba
            document.getElementById('gameCanvas').addEventListener('click', (e) => {
                const rect = e.target.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                console.log(`üñ±Ô∏è Click en (${x}, ${y})`);
                
                const planet = gameEngine.getPlanetAtPosition(x, y);
                if (planet) {
                    console.log(`ü™ê Planeta clickeado: ${planet.id} (${planet.owner})`);
                }
            });

            console.log('‚úÖ Galcon iniciado correctamente');

        } catch (error) {
            console.error('‚ùå Error iniciando Galcon:', error);
            document.getElementById('gameStatus').textContent = 'Error ‚ùå';
        }
    </script>
</body>
</html> 