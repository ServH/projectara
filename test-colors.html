<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé® Test de Colores - Galcon</title>
    <link rel="stylesheet" href="css/main.css">
    <style>
        .test-info {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            z-index: 1000;
            max-width: 300px;
        }
        .color-test {
            margin: 5px 0;
            padding: 5px;
            border: 1px solid #333;
        }
        .color-sample {
            display: inline-block;
            width: 30px;
            height: 30px;
            border: 2px solid white;
            margin-right: 10px;
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <!-- Info de Test -->
    <div class="test-info">
        <h4>üé® Test de Colores</h4>
        <div class="color-test">
            <span class="color-sample" style="background-color: #00ff88;"></span>
            Player: #00ff88
        </div>
        <div class="color-test">
            <span class="color-sample" style="background-color: #ff4444;"></span>
            AI: #ff4444
        </div>
        <div class="color-test">
            <span class="color-sample" style="background-color: #888888;"></span>
            Neutral: #888888
        </div>
        <hr>
        <div id="gameStatus">Iniciando...</div>
        <div>Planetas: <span id="planetCount">0</span></div>
        <div>Flotas: <span id="fleetCount">0</span></div>
        <hr>
        <div style="font-size: 10px;">
            Click en planetas verdes para enviar flotas
        </div>
    </div>

    <!-- Canvas del Juego -->
    <svg id="gameCanvas" width="100%" height="100%"></svg>

    <!-- Scripts -->
    <script type="module">
        import GameEngine from './src/core/GameEngine.js';
        import Renderer from './src/visual/Renderer.js';

        console.log('üé® Iniciando test de colores...');

        try {
            // Crear GameEngine y Renderer
            const gameEngine = new GameEngine();
            const renderer = new Renderer(gameEngine);

            // Inicializar
            gameEngine.init();
            renderer.start();

            document.getElementById('gameStatus').textContent = 'Funcionando ‚úÖ';

            // Funci√≥n para actualizar info
            function updateInfo() {
                const renderData = gameEngine.getRenderData();
                document.getElementById('planetCount').textContent = renderData.planets.length;
                document.getElementById('fleetCount').textContent = renderData.fleets.length;

                // Log de colores cada 5 segundos
                if (Math.floor(Date.now() / 5000) % 2 === 0) {
                    console.log('üé® Verificando colores de planetas:');
                    renderData.planets.slice(0, 5).forEach(planet => {
                        console.log(`  ${planet.id}: ${planet.owner} -> ${planet.color}`);
                    });
                    
                    if (renderData.fleets.length > 0) {
                        console.log('üöÄ Verificando colores de flotas:');
                        renderData.fleets.slice(0, 3).forEach(fleet => {
                            console.log(`  ${fleet.id}: ${fleet.owner} -> ${fleet.color}`);
                        });
                    }
                }
            }

            // Actualizar cada segundo
            setInterval(updateInfo, 1000);
            updateInfo();

            // Click handler para enviar flotas
            document.getElementById('gameCanvas').addEventListener('click', (e) => {
                const rect = e.target.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                const planet = gameEngine.getPlanetAtPosition(x, y);
                if (planet) {
                    console.log(`üñ±Ô∏è Click en planeta ${planet.id} (${planet.owner})`);
                    
                    if (planet.owner === 'player' && planet.ships > 1) {
                        // Buscar planeta neutral para atacar
                        const planets = Array.from(gameEngine.planets.values());
                        const targets = planets.filter(p => p.owner !== 'player' && p !== planet);
                        
                        if (targets.length > 0) {
                            const target = targets[Math.floor(Math.random() * targets.length)];
                            console.log(`üöÄ Enviando flota desde ${planet.id} a ${target.id}`);
                            planet.sendFleet(target, 0.5);
                        }
                    }
                }
            });

            console.log('‚úÖ Test de colores iniciado');

        } catch (error) {
            console.error('‚ùå Error en test de colores:', error);
            document.getElementById('gameStatus').textContent = 'Error ‚ùå';
        }
    </script>
</body>
</html> 