<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>ğŸ¯ Test MÃ­nimo - Hito 1A</title>
    <style>
        body { margin: 0; padding: 20px; background: #000; color: #fff; font-family: monospace; }
        #gameCanvas { border: 2px solid #333; background: radial-gradient(ellipse at center, #000033 0%, #000011 70%, #000000 100%); }
        .controls { margin: 20px 0; }
        button { padding: 10px 20px; background: #333; color: #fff; border: 1px solid #666; cursor: pointer; margin-right: 10px; }
        button:hover { background: #555; }
    </style>
</head>
<body>
    <h1>ğŸ¯ Test MÃ­nimo - Hito 1A</h1>
    <p>Test simple para verificar que las naves aparecen y se orientan correctamente</p>
    
    <div class="controls">
        <button onclick="createTestFleet()">ğŸš€ Crear Nave de Prueba</button>
        <button onclick="clearCanvas()">ğŸ—‘ï¸ Limpiar</button>
    </div>
    
    <svg id="gameCanvas" width="800" height="600"></svg>

    <script type="module">
        import { Fleet } from './src/entities/Fleet.js';
        
        let testFleet = null;
        let renderer = null;
        
        // Mock simple del GameEngine
        const mockGameEngine = {
            getPlanet: () => ({ x: 650, y: 200, id: 'target' })
        };
        
        // Crear nave de prueba
        window.createTestFleet = function() {
            console.log('ğŸ¯ Creando nave de prueba...');
            
            // Datos de flota simples
            const fleetData = {
                id: 'test-fleet-' + Date.now(),
                ships: 5,
                owner: 'player',
                fromPlanet: 'planet1',
                toPlanet: 'planet2',
                startX: 150,
                startY: 300,
                targetX: 650,
                targetY: 200,
                launchTime: Date.now()
            };
            
            console.log('ğŸ¯ Datos de flota:', fleetData);
            
            // Crear flota
            testFleet = new Fleet(fleetData);
            console.log('ğŸ¯ Flota creada:', testFleet);
            
            // Crear elemento visual manualmente (como en test-hito1a)
            createVisualFleet(testFleet);
            
            // Animar
            animateFleet();
        };
        
        function createVisualFleet(fleet) {
            const canvas = document.getElementById('gameCanvas');
            
            // Crear grupo
            const group = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            group.setAttribute('id', `fleet-${fleet.id}`);
            
            // Crear triÃ¡ngulo (EXACTAMENTE como en test-hito1a)
            const triangle = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
            const size = 8;
            const points = [
                [size, 0],           // Punta hacia la derecha
                [-size/2, -size/2],  // Esquina superior
                [-size/2, size/2]    // Esquina inferior
            ];
            
            const pointsStr = points.map(p => p.join(',')).join(' ');
            triangle.setAttribute('points', pointsStr);
            triangle.setAttribute('fill', '#00ff88');
            triangle.setAttribute('stroke', '#00ff88');
            triangle.setAttribute('stroke-width', '1');
            
            // Calcular orientaciÃ³n inicial
            const dx = fleet.targetX - fleet.x;
            const dy = fleet.targetY - fleet.y;
            const angle = Math.atan2(dy, dx) * (180 / Math.PI);
            
            triangle.setAttribute('transform', `translate(${fleet.x}, ${fleet.y}) rotate(${angle})`);
            
            group.appendChild(triangle);
            canvas.appendChild(group);
            
            console.log(`ğŸ¯ Nave visual creada en (${fleet.x}, ${fleet.y}) orientada ${Math.round(angle)}Â° hacia (${fleet.targetX}, ${fleet.targetY})`);
        }
        
        function animateFleet() {
            if (!testFleet || testFleet.hasArrived) return;
            
            // Actualizar flota
            testFleet.update(16);
            
            // Actualizar visual
            const triangle = document.querySelector(`#fleet-${testFleet.id} polygon`);
            if (triangle) {
                const dx = testFleet.targetX - testFleet.x;
                const dy = testFleet.targetY - testFleet.y;
                const angle = Math.atan2(dy, dx) * (180 / Math.PI);
                
                triangle.setAttribute('transform', `translate(${testFleet.x}, ${testFleet.y}) rotate(${angle})`);
            }
            
            requestAnimationFrame(animateFleet);
        }
        
        window.clearCanvas = function() {
            const canvas = document.getElementById('gameCanvas');
            while (canvas.firstChild) {
                canvas.removeChild(canvas.firstChild);
            }
            testFleet = null;
            console.log('ğŸ—‘ï¸ Canvas limpiado');
        };
        
        console.log('ğŸ¯ Test mÃ­nimo listo');
    </script>
</body>
</html> 